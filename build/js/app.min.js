!function(a){"use strict";function b(a,b){b.when("","/").otherwise("/"),a.state("home",{url:"/",templateUrl:"../public/app/views/home/home.html",controller:"HomeController as homeCtrl"}).state("exhibits",{url:"/exhibits",templateUrl:"../public/app/views/exhibits/exhibits.html",controller:"ExhibitsController as exhibitsCtrl"}).state("exhibit",{url:"/exhibits/:id",templateUrl:"../public/app/views/exhibit/exhibit.html",controller:"ExhibitController as exhibitCtrl"}).state("docent",{url:"/docents/:id",templateUrl:"../public/app/views/docent/docent.html",controller:"DocentController as docentCtrl"}),a.state("admin",{"abstract":!0,url:"/admin",template:"<ui-view />"}).state("admin.beacons",{url:"/beacons",templateUrl:"../public/app/views/admin/beacons/beacons.html",controller:"BeaconsListController as beaconsCtrl"}).state("admin.beaconPage",{url:"/beacons/:id",templateUrl:"../public/app/views/admin/beacon/beacon.html",controller:"BeaconController as beaconCtrl"}).state("admin.analytics",{url:"/analytics",templateUrl:"../public/app/views/admin/analytics/analytics.html",controller:"AnalyticsController as analyticsCtrl"}).state("admin.forms",{"abstract":!0,url:"/forms",template:"<ui-view />"}).state("admin.forms.docent",{url:"/docent/:id",templateUrl:"../public/app/views/admin/forms/docent/docent.html",controller:"DocentFormController as formCtrl"}).state("admin.forms.exhibit",{url:"/exhibit/:id",templateUrl:"../public/app/views/admin/forms/exhibit/exhibit.html",controller:"ExhibitFormController as formCtrl"})}b.$inject=["$stateProvider","$urlRouterProvider"],a.module("sky-beacons",["ui.router","sky","ui.bootstrap","sky-beacons.templates"]).config(b)}(window.angular),function(a){"use strict";function b(a){var b;b=this,b.getAll=function(){return a.get("/api/beacons/").then(function(a){return a.data})}}b.$inject=["$http"],a.module("sky-beacons").service("BeaconService",b)}(window.angular),function(a){"use strict";function b(a,b){var c;c=this,c.getAll=function(){return a.get("/api/docents/").then(function(a){return a.data})},c.getById=function(b){return a.get("/api/docents/"+b).then(function(a){return a.data})},c.deleteById=function(c){var d;return d=b.defer(),a({method:"DELETE",url:"/api/docents/"+c,headers:{"Content-Type":"application/json;charset=utf-8"}}).then(function(a){d.resolve(a.data)}),d.promise},c.add=function(c){var d=b.defer();return a.post("/api/docents/",{data:c,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){a.data.error?d.resolve(a.data):d.resolve(a.data)}),d.promise},c.edit=function(c){var d;return d=b.defer(),a.put("/api/docents/"+c._id,{data:c}).then(function(a){a.data.error?d.resolve(a.data):d.resolve(a.data)}),d.promise}}b.$inject=["$http","$q"],a.module("sky-beacons").service("DocentService",b)}(window.angular),function(a){"use strict";function b(a,b){var c;c=this,c.getAll=function(){return a.get("/api/exhibits/").then(function(a){return a.data})},c.getById=function(b){return a.get("/api/exhibits/"+b).then(function(a){return a.data})},c.deleteById=function(c){var d;return d=b.defer(),a({method:"DELETE",url:"/api/exhibits/"+c,headers:{"Content-Type":"application/json;charset=utf-8"}}).then(function(a){d.resolve(a.data)}),d.promise},c.add=function(c){var d=b.defer();return a.post("/api/exhibits/",{data:c,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){a.data.error?d.resolve(a.data):d.resolve(a.data)}),d.promise},c.edit=function(c){var d;return d=b.defer(),a.put("/api/exhibits/"+c._id,{data:c}).then(function(a){a.data.error?d.resolve(a.data):d.resolve(a.data)}),d.promise}}b.$inject=["$http","$q"],a.module("sky-beacons").service("ExhibitService",b)}(window.angular),function(a,b){"use strict";function c(){return{link:function(b,c,d){var e,f;f=d.ccConfirmClick||"Are you sure?",e=d.confirmedClick,c.bind("click",function(c){a.confirm(f)&&b.$eval(e)})}}}b.module("sky-beacons").directive("ccConfirmClick",c)}(window,window.angular),function(a){"use strict";function b(a,b,c){function d(a,b,c){var d,e,f=[];for(d=a.length;d--;)e=a[d],e.date_indate>=b&&e.date_indate<=c&&f.indexOf(e.sessionId)<0&&f.push(e.sessionId);return f.length}function e(a,b){var c=new Date(a);return c.setHours(c.getHours()+b),c}function f(a,b){var c=new Date(a);return c.setDate(c.getDate()+b),c}function g(a){var b,c=new Date,g=new Date(c.getFullYear(),c.getMonth(),c.getDate());for(b=a.visits.length;b--;)a.visits[b].date_indate=new Date(a.visits[b].date);a.cards=[],a.cards.push({title:"Visitors This Hour",count:d(a.visits,e(c,-1),c)}),a.cards.push({title:"Visitors Last Hour",count:d(a.visits,e(c,-2),e(c,-1))}),a.cards.push({title:"Visitors Today",count:d(a.visits,g,f(g,1))}),a.cards.push({title:"Visitors Yesterday",count:d(a.visits,f(g,-1),g)}),a.cards.push({title:"Visitors Last 7 Days",count:d(a.visits,f(c,-7),c)}),a.cards.push({title:"Visitors Last 30 Days",count:d(a.visits,f(c,-30),c)})}var h=this;b.getAll().then(function(a){var b;for(h.beacons=a.value,b=h.beacons.length;b--;)g(h.beacons[b])})}b.$inject=["$stateParams","ExhibitService","$state"],a.module("sky-beacons").controller("AnalyticsController",b)}(window.angular),function(a){"use strict";function b(a,b,c){function d(a,b,c){var d,e,f=[];for(d=a.length;d--;)e=a[d],e.date_indate>=b&&e.date_indate<=c&&f.indexOf(e.sessionId)<0&&f.push(e.sessionId);return f.length}function e(a,b){var c=new Date(a);return c.setHours(c.getHours()+b),c}function f(a,b){var c=new Date(a);return c.setDate(c.getDate()+b),c}function g(){var a,b=new Date,c=new Date(b.getFullYear(),b.getMonth(),b.getDate());for(a=h.beacon.visits.length;a--;)h.beacon.visits[a].date_indate=new Date(h.beacon.visits[a].date);h.cards=[],h.cards.push({title:"Visitors This Hour",count:d(h.beacon.visits,e(b,-1),b)}),h.cards.push({title:"Visitors Last Hour",count:d(h.beacon.visits,e(b,-2),e(b,-1))}),h.cards.push({title:"Visitors Today",count:d(h.beacon.visits,c,f(c,1))}),h.cards.push({title:"Visitors Yesterday",count:d(h.beacon.visits,f(c,-1),c)}),h.cards.push({title:"Visitors Last 7 Days",count:d(h.beacon.visits,f(b,-7),b)}),h.cards.push({title:"Visitors Last 30 Days",count:d(h.beacon.visits,f(b,-30),b)})}var h=this;b.getById(a.id).then(function(a){h.beacon=a,g()}),h.goToEdit=function(a){switch(h.beacon.beaconType){case"docent":c.go("admin.forms.docent",{id:h.beacon._id});break;case"exhibit":c.go("admin.forms.exhibit",{id:h.beacon._id})}}}b.$inject=["$stateParams","ExhibitService","$state"],a.module("sky-beacons").controller("BeaconController",b)}(window.angular),function(a){"use strict";function b(a,b){var c=this;b.getAll().then(function(a){c.beacons=a.value}),c.goToEdit=function(b){switch(b.beaconType){case"person":a.go("admin.forms.docent",{id:b._id});break;case"exhibit":a.go("admin.forms.exhibit",{id:b._id})}}}b.$inject=["$state","BeaconService"],a.module("sky-beacons").controller("BeaconsListController",b)}(window.angular),function(a){"use strict";function b(a,b,c){var d,e;e=this,e.formData={beaconType:"docent"},d=function(a){switch(e.error=a.error.message||a.error.errmsg,a.error.code){case 4:case 5:e.needsLogin=!0}},b.params.id?c.getById(b.params.id).then(function(a){e.formData=a,e.isReady=!0}):e.isReady=!0,e["delete"]=function(){c.deleteById(e.formData._id).then(function(a){a.success?b.go("home"):d(a)})},e.submit=function(){e.error=!1,e.success=!1,e.scrollToTop=!1,e.formData._id?c.edit(e.formData).then(function(a){a.error&&d(a),e.success="Docent successfully updated.",e.formData=a,e.scrollToTop=!0}):c.add(e.formData).then(function(a){a.error&&d(a),e.success="Docent successfully created.",e.formData=a,e.scrollToTop=!0})},e.trustHtml=function(b){return a.trustAsHtml(b)}}b.$inject=["$sce","$state","DocentService"],a.module("sky-beacons").controller("DocentFormController",b)}(window.angular),function(a){"use strict";function b(a,b,c){var d,e;e=this,e.formData={beaconType:"exhibit"},d=function(a){switch(e.error=a.error.message||a.error.errmsg,a.error.code){case 4:case 5:e.needsLogin=!0}},b.params.id?c.getById(b.params.id).then(function(a){e.formData=a,console.log(a),e.isReady=!0}):e.isReady=!0,e.addPiece=function(){e.formData.pieces||(e.formData.pieces=[]),e.formData.pieces.push({})},e["delete"]=function(){c.deleteById(e.formData._id).then(function(a){a.success?b.go("home"):d(a)})},e.removePiece=function(a){e.formData.pieces.splice(a,1)},e.submit=function(){e.error=!1,e.success=!1,e.scrollToTop=!1,e.formData._id?c.edit(e.formData).then(function(a){return a.error?d(a):(e.success="Exhibit successfully updated.",e.formData=a,void(e.scrollToTop=!0))}):c.add(e.formData).then(function(a){return a.error?d(a):(e.success="Exhibit successfully created.",e.formData=a,void(e.scrollToTop=!0))})},e.trustHtml=function(b){return a.trustAsHtml(b)}}b.$inject=["$sce","$state","ExhibitService"],a.module("sky-beacons").controller("ExhibitFormController",b)}(window.angular),function(a){"use strict";function b(a,b){var c;c=this,a.getById(b.id).then(function(a){c.docent=a})}b.$inject=["DocentService","$stateParams"],a.module("sky-beacons").controller("DocentController",b)}(window.angular),function(a){"use strict";function b(a,b){var c;c=this,a.getById(b.id).then(function(a){c.exhibit=a})}b.$inject=["ExhibitService","$stateParams"],a.module("sky-beacons").controller("ExhibitController",b)}(window.angular),function(a){"use strict";function b(){}a.module("sky-beacons").controller("ExhibitsController",b)}(window.angular),function(a){"use strict";function b(a,b){var c;c=this,a.getAll().then(function(a){c.docents=a.value}),b.getAll().then(function(a){c.exhibits=a.value})}b.$inject=["DocentService","ExhibitService"],a.module("sky-beacons").controller("HomeController",b)}(window.angular),angular.module("sky-beacons.templates",[]).run(["$templateCache",function(a){a.put("../public/app/views/admin/analytics/analytics.html",'<div><div ng-repeat="beacon in analyticsCtrl.beacons"><h2 style="margin: 0 20px">{{beacon.name}}</h2><bb-carousel bb-carousel-style=card-small><bb-carousel-item ng-repeat="card in beacon.cards"><bb-card bb-card-size=small><bb-card-title>{{card.title}}</bb-card-title><bb-card-content style="margin-left: auto; margin-right: auto; font-size: 80px">{{card.count}}</bb-card-content></bb-card></bb-carousel-item></bb-carousel></div></div>'),a.put("../public/app/views/admin/beacon/beacon.html",'<div><bb-page-summary><bb-page-summary-image><bb-avatar bb-avatar-name=beaconCtrl.beacon.name bb-avatar-src=beaconCtrl.beacon.image></bb-avatar></bb-page-summary-image><bb-page-summary-title>{{beaconCtrl.beacon.name}}</bb-page-summary-title><bb-page-summary-subtitle>{{beaconCtrl.beacon.beaconType}}</bb-page-summary-subtitle><bb-page-summary-content><span class=bb-text-block>{{beaconCtrl.beacon.description}}</span></bb-page-summary-content><bb-page-summary-action-bar><bb-action-bar><bb-action-bar-item ng-click=beaconCtrl.goToEdit()>Edit</bb-action-bar-item></bb-action-bar></bb-page-summary-action-bar></bb-page-summary><div style="margin-top: 10px"><bb-carousel bb-carousel-style=card-small><bb-carousel-item ng-repeat="card in beaconCtrl.cards"><bb-card bb-card-size=small><bb-card-title>{{card.title}}</bb-card-title><bb-card-content style="margin-left: auto; margin-right: auto; font-size: 80px">{{card.count}}</bb-card-content></bb-card></bb-carousel-item></bb-carousel></div></div>'),a.put("../public/app/views/admin/beacons/beacons.html",'<div class=container><bb-carousel bb-carousel-style=card-large><bb-carousel-item ng-repeat="beacon in beaconsCtrl.beacons"><bb-card bb-card-size=large><bb-card-title>{{beacon.name}}</bb-card-title><bb-card-content><div class=bb-emphasized>ID</div>{{beacon.UID}}<div class=bb-emphasized style="margin-top: 10px">Type</div>{{beacon.beaconType}}<div class=bb-emphasized style="margin-top: 10px">Description</div>{{beacon.description}}</bb-card-content><bb-card-actions><button type=button class="btn btn-primary" ui-sref=admin.beaconPage({id:beacon._id})>More information</button> <button type=button class="btn btn-default" ng-click=beaconsCtrl.goToEdit(beacon)>Edit</button></bb-card-actions></bb-card></bb-carousel-item></bb-carousel><p><a ui-sref=admin.forms.exhibit()>Create Exhibit</a></p><p><a ui-sref=admin.forms.docent()>Create Docent</a></p></div>'),a.put("../public/app/views/admin/forms/docent/docent.html",'<div class=container ng-if=::formCtrl.isReady><div class=page-header bb-scroll-into-view=formCtrl.scrollToTop><h1 ng-if=formCtrl.formData._id>Edit {{ formCtrl.formData.name }}</h1><h1 ng-if=!formCtrl.formData._id>Add Docent</h1></div><div ng-if=formCtrl.success class="alert alert-success" ng-bind-html=formCtrl.trustHtml(formCtrl.success)></div><div ng-if=formCtrl.error class="alert alert-danger"><p ng-bind-html=formCtrl.trustHtml(formCtrl.error)></p></div><form name=docentForm class=form-horizontal ng-submit=formCtrl.submit() novalidate><div class=row><div class=col-sm-10><div class=form-group><label class="col-sm-2 control-label">Name:</label><div class=col-sm-10><input class=form-control name=name ng-model=formCtrl.formData.name></div></div><div class=form-group><label class="col-sm-2 control-label">Beacon UID:</label><div class=col-sm-10><input class=form-control name=UID ng-model=formCtrl.formData.UID></div></div><div class=form-group><label class="col-sm-2 control-label">Title:</label><div class=col-sm-10><input class=form-control name=title ng-model=formCtrl.formData.title></div></div><div class=form-group><label class="col-sm-2 control-label">Expertise:</label><div class=col-sm-10><input class=form-control name=expertise ng-model=formCtrl.formData.expertise></div></div><div class=form-group><label class="col-sm-2 control-label">Image URL:</label><div class=col-sm-10><input class=form-control name=image ng-model=formCtrl.formData.image></div></div><div class=form-group><label class="col-sm-2 control-label">Bio:</label><div class=col-sm-10><textarea class=form-control name=description ng-model=formCtrl.formData.description></textarea></div></div></div><div class=col-sm-2><button ng-if=formCtrl.formData._id class="btn btn-primary btn-lg btn-block" type=submit ng-disabled=docentForm.$invalid><i class="fa fa-save"></i>Save</button> <button ng-if=!formCtrl.formData._id class="btn btn-primary btn-lg btn-block" type=submit ng-disabled=docentForm.$invalid><i class="fa fa-plus"></i>Create</button> <button ng-if=formCtrl.formData._id class="btn btn-danger btn-block" type=button cc-confirm-click data-confirmed-click=formCtrl.delete()><i class="fa fa-trash"></i>Delete</button></div></div></form></div>'),a.put("../public/app/views/admin/forms/exhibit/exhibit.html",'<div class=container ng-if=::formCtrl.isReady><div class=page-header bb-scroll-into-view=formCtrl.scrollToTop><h1 ng-if=formCtrl.formData._id>Edit {{ formCtrl.formData.name }}</h1><h1 ng-if=!formCtrl.formData._id>Add Exhibit</h1></div><div ng-if=formCtrl.success class="alert alert-success" ng-bind-html=formCtrl.trustHtml(formCtrl.success)></div><div ng-if=formCtrl.error class="alert alert-danger"><p ng-bind-html=formCtrl.trustHtml(formCtrl.error)></p></div><form name=exhibitForm class=form-horizontal ng-submit=formCtrl.submit() novalidate><div class=row><div class=col-sm-10><ul class="nav nav-tabs"><li role=presentation class=active><a href=#tab-details target=_self data-toggle=tab>Details</a></li><li role=presentation><a href=#tab-pieces target=_self data-toggle=tab>Pieces</a></li></ul><div class=tab-content><div class="tab-pane active" id=tab-details><div class=form-group><label class="col-sm-2 control-label">Name:</label><div class=col-sm-10><input class=form-control name=name ng-model=formCtrl.formData.name></div></div><div class=form-group><label class="col-sm-2 control-label">Beacon UID:</label><div class=col-sm-10><input class=form-control name=UID ng-model=formCtrl.formData.UID></div></div><div class=form-group><label class="col-sm-2 control-label">Image URL:</label><div class=col-sm-10><input class=form-control name=image ng-model=formCtrl.formData.image></div></div><div class=form-group><label class="col-sm-2 control-label">Description:</label><div class=col-sm-10><textarea class=form-control name=description ng-model=formCtrl.formData.description></textarea></div></div></div><div class=tab-pane id=tab-pieces><div class=form-group><label class="col-sm-2 control-label">Pieces:</label><div class=col-sm-10><div ng-repeat="piece in formCtrl.formData.pieces" class=form-group-list-item><div class=row><div class=col-sm-10><div class=row><div class=col-sm-6><div class=form-group><label>Name:</label><input class=form-control ng-model=piece.name></div></div><div class=col-sm-6><div class=form-group><label>Description:</label><textarea class=form-control type=text ng-model=piece.description></textarea></div></div></div><div class=row><div class=col-sm-6><div class=form-group><label>Full URL:</label><input class=form-control ng-model=piece.link placeholder="http://"></div></div><div class=col-sm-6><div class=form-group><label>Image URL:</label><input class=form-control ng-model=piece.image placeholder="http://"></div></div></div></div><div class=col-sm-2><div class=form-group><label>&nbsp;</label><button type=button class="btn btn-default btn-sm btn-block" ng-click=formCtrl.removePiece($index)><i class="fa fa-minus"></i>Remove</button></div></div></div></div><button type=button class="btn btn-link" ng-click=formCtrl.addPiece()><i class="fa fa-plus"></i> Add Piece</button></div></div></div></div></div><div class=col-sm-2><button ng-if=formCtrl.formData._id class="btn btn-primary btn-lg btn-block" type=submit ng-disabled=exhibitForm.$invalid><i class="fa fa-save"></i>Save</button> <button ng-if=!formCtrl.formData._id class="btn btn-primary btn-lg btn-block" type=submit ng-disabled=exhibitForm.$invalid><i class="fa fa-plus"></i>Create</button> <button ng-if=formCtrl.formData._id class="btn btn-danger btn-block" type=button cc-confirm-click data-confirmed-click=formCtrl.delete()><i class="fa fa-trash"></i>Delete</button></div></div></form></div>'),a.put("../public/app/views/docent/docent.html",'<section class="section container"><h1 class=page-header>{{:: docentCtrl.docent.name }}</h1><img class="ex-image img-responsive" src="{{:: docentCtrl.docent.image }}"><p class=ex-description>{{:: docentCtrl.docent.description }}</p></section>'),a.put("../public/app/views/exhibit/exhibit.html",'<section class="section container"><h1 class=page-header>{{:: exhibitCtrl.exhibit.name }}</h1><img class="ex-image img-responsive" ng-src="{{:: exhibitCtrl.exhibit.image }}"><p class=ex-description>{{:: exhibitCtrl.exhibit.description }}</p></section><section class=container><h2>Pieces in this exhibit</h2><div class=media ng-repeat="piece in exhibitCtrl.exhibit.pieces"><div class=media-left><a href=#><img class=media-object ng-src={{piece.image}} alt=""></a></div><div class=media-body><h4 class=media-heading>{{piece.name}}</h4><p>{{piece.description}}</p><p><a href={{piece.link}}>Read more</a></p></div></div></section>'),a.put("../public/app/views/exhibits/exhibits.html","Hello, World!"),a.put("../public/app/views/home/home.html",'<section class="section home section-primary"><header class=container><h1>Sky Beacons</h1></header></section><div class=container><div class=row><div class=col-md-12><h2 class=home-subhead>Exhibits</h2></div><div ng-repeat="exhibit in homeCtrl.exhibits" class=col-md-4><div class="panel panel-default"><div class=panel-heading><h3 class="bb-section-heading panel-title">{{:: exhibit.name }}</h3></div><div class=panel-body><img class=img-responsive ng-src="{{:: exhibit.image }}"> <button class="btn btn-primary pull-right" ui-sref="exhibit({id: exhibit._id})">View</button></div></div></div></div><div class=row><div class=col-md-12><h2 class=home-subhead>Docents</h2></div><div ng-repeat="docent in homeCtrl.docents" class=col-md-4><div class="panel panel-default"><div class=panel-heading><h3 class="bb-section-heading panel-title">{{:: docent.name }}</h3><h5 class=bb-section-subheading>{{:: docent.expertise}}</h5></div><div class=panel-body><img class=img-responsive ng-src="{{:: docent.image }}"> <button class="btn btn-primary pull-right" ui-sref="docent({id: docent._id})">View</button></div></div></div></div></div>')}]);
//# sourceMappingURL=app.min.js.map